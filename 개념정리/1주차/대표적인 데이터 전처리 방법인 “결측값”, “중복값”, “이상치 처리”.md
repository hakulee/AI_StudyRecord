# 데이터 전처리가 중요한 이유
- 분석 결과를 왜곡시킬 수 있음
- 모델 성능을 저하시킬 수 있음
- 숨겨진 정보가 있을 수 있음 ex) 게임업계의 현질을 많이 한사람 등

# 기본적인 데이터 전처리 단계
1. 기본적인 데이터 확인
   - 우선 크게 **결측값, 중복값, 이상치** 확인

2. 문제가 있다면 원인분석
   - 원인 분석: 왜 데이터에 문제가 발생했는지 파악

3. 데이터 전처리 방법
   - 제거: 명백한 오류인 경우
   - 대체: 평균, 중앙값, capping 등의 값으로 변경 (사용할 가능성은 적음)
   - 보존: 중요한 정보이거나 모델이 강건할 경우
   - 변환: 로그 변환 등으로 데이터 분포 조절 (모델링 시 많이 사용)
     
## 결측값
결측값은 수집되지 않았거나, 알 수 없거나, 잘못 입력된 값으로, 데이터셋에서 특정 변수의 값이 비어있는 상태
- 결측치 확인
   ```python
   # 결측치 확인
   df.isna()
   # or
   df.isnull()

   # sum을 붙이면 결측치 개수로 환산하여 볼수 있음
   df.isnull().sum()

   # 결측치가 전체의 몇퍼센트 있는지 확인하는 방법
   df.isnull().mean().sort_values(ascending=False)*100

   # 결측치 그림으로 확인
   import seaborn as sns
   import matplotlib.pyplot as plt

   sns.heatmap(df.isnull(), cbar=False, yticklabels=False)
   plt.show()
   ```
   > 데이터를 읽었을 때 **NaN**이나 **null** 값 등으로 표시됨

- 결측치 제거
   ```python
   # 결측값 처리 예시1
   # 결측값을 평균으로 대체
   df['특정컬럼']=df['특정컬럼'].fillna(df['특정컬럼'].mean())

   # 결측값 처리 예시2
   # 결측치가 있는 모든 행 제거
   df.dropna()

   # 결측값 처리 예시2
   # 특정 열의 결측치만 제거
   df = df.drop(columns=['특정컬럼'])
   ```

## 중복값
데이터의 중복값은 데이터 집합 내에서 동일한 값을 가지는 데이터 항목
- 중복값 확인
   ```python
   # 중복된 행의 개수 출력
   print(df.duplicated(keep = False).sum())

   # 중목된 행 출력
   [df.duplicated(keep = False)]


   # 중복값 처리
   df = df.drop_duplicates()
   ```

## 이상치
대부분의 다른 데이터 포인트와 비교했을 때, 정상적인 범위에서 크게 벗어나 독특하게 보이는 데이터
- 이상치 확인
   ```python
   y = [-1, 5, 7, 8, 9, 10, 12, 13, 14, 20, 50]
   q1 = np.percentile(y, 25) # 상위 25%
   q2 = np.percentile(y, 50) # 상위 50%; 중앙값
   q3 = np.percentile(y, 75) # 상위 75%
   IQR = q3 - q1
   ```
   <img width="637" height="279" alt="image" src="https://github.com/user-attachments/assets/4a9aa970-7d7c-46a6-a046-c0fa0f8664d6" />
   
   > boxplot 또는 Heatmap 등의 시각화로 확인   

   > 이상치를 확인하는 방법은 IQR 외에도 z-score(표준화 점수), 이동 평균 방식 등이 있음   
   > 기본적으로는 IQR을 사용   
   > z-score는 데이터 통계 분석 시 주로 사용 (절댓값이 2또는 3 이상인 경우 이상치로 판단)   
   > 이동 평균 방식은 전체 중 구간별 평균을 낸 후 전체 표준편차의 특정 임계값을 초과하는 데이터를 이상치로 식별, 주로 시계열 데이터에서 사용   
   > 이외에도 머신러닝 기반 방법론이 있음 ex) DBDCAN, Isolation Forest... 등등

- 이상치 처리
```python
# 이상치 조건 (Q1 - 1.5*IQR 보다 작거나, Q3 + 1.5*IQR 보다 큰 값)
outliers = (df["Quantity"] < (q1-1.5*iqr)) | (df["Quantity"] > (q3 + 1.5*iqr))

# 이상치를 제외한 데이터프레임 생성
df_no = df[~outliers]
```
> 이외에도 방법은 많지만 우선 여기까지...
